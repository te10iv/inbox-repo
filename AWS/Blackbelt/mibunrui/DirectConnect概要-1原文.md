# AWS Direct Connect 概要〜これだけはおさえておきたいこと〜【AWS Black Belt】

AWS Direct Connect 概要〜これだけはおさえておきたいこと〜【AWS Black Belt】
https://www.youtube.com/watch?v=B6daP3Cvyks

動画の関連情報



チャプター

文字起こし

 AWS Black Belt Online セミナーとは
AWSブラックベルトオンラインセミナー
にようこそ。本セッションではAWS
ダイレクトコネクト概要といたしまして
これだけは抑えていただきたいこと、基本
的なサービスの概要、機能と接続パターン
、上構成についてご紹介いたします。
Wです
別、ソリューション別、業子別などの
テーマに分け、AmazonWeb
サービスJAPAN合同会社が提供する
オンラインセミナーシリーズです。
内容についての注意点ですが、本資料では
資料作成時点のサービス内容に基づきご
説明しています。
AWSのサービスは常にアップデートを
続けているため、最新の情報はAWS公式
ウェブサイトにてご確認ください。
初めに自己紹介をさせていただきます。
AWSの斎藤と申します。普段は優行売り
消費剤のお客様を中心に技術支援してい
ます。好きなサービスはAmazon
VPCです。
 受講対象者
本セミナーはネットワーク担当者に限らず
AWSクラウドに関わるエンジニアの方
全般を対象にしています。
クラウド担当者に求められる技術領域は
ますます広くなってきており、
ネットワークのバックグラウンド、知識が
ない方もダイレクトコネクトの検討設計に
関わる必要がある場合がございます。
方たちにもお伝えしたい内容としており
ます。
 アジェンダ
また本セミナーにおける目標ですがAWS
ダイレクトコネクトを検討する際に必ず
議題に上がるであろう接続パターンと上
構成について理解していただくことです。
ここでは概要に絞ってお伝えしますので、
より詳細な内容について知りたい場合は、
最後に提示するドキュメントや資料、過去
のブラックベルト資料をご確認ください。
今後ダイレクトコネクトの詳細編の
ブラックベルトオンラインセミナー
シリーズの公開も予定しております。
こちらがアジェンダです。初めにAWS
ダイレクトコネクトの概要について説明し
ます。続いて接続パターン上構成について
お話しさせていただきます。
 AWS Direct Connect について
前置きが長くなりましたがそれでは始めて
いきましょう。
AWSダイレクトコネクトはAWSへの
専用ネットワーク接続サービスで
インターネットを返さずお客様の設備と
AWS艦のプライベートネットワーク接続
が実現できます。
接続ポイントとなるダイレクトコネクト
ロケーションは世界中に存在し、日本では
関東、関西、それぞれ複数のロケーション
が提供されています。リストについては
リンク先をご参照ください。
こちらの図ですが、左側はオンレミス、
右側がAWSで、その間をダイレクト
コネクトロケーションで接続します。
資料上DXと記載してる部分がありますが
、ダイレクトコネクトの略勝とご認識
ください。
ダイレクトコネクトはそのダイレクト
コネクトロケーションにあるAWSの
ルーターとAWSクラウド間の範囲で提供
される機能となります。
一方で左側のオンレミスからダイレクト
コネクトロケーション
ダイレクトコネクトロケーション内での
AWSルーターまでの配線については
キャリアデータセンター事業者から提供さ
れるものとなっています。
本資料での図は画面に向かって左側に
オンレミス、右側がAWSクラウドと統一
していますのでその前提でご覧ください。
こちらはダイレクトコネクトロケーション
をクローズアップした図です。ダイレクト
コネクトロケーションではAWSの
ルーターとお客様、またはパートナー様の
ルーターと物理的に校内配線で接続する
ことになります。
校内配線はデータセンター事業者様へ手配
していただき、METmeーと呼ばれる
部屋でパッチパネルを経由して接続され
ます。
次にお客様拠点との接続パターンについて
見てみましょう。
真ん中がダイレクトコネクトロケーション
になりますが、1はお客様のネットワーク
機器をダイレクトコネクトロケーションに
配置いただくパターンです。左側がオン
プレミスで何らかの回線で接続するもの
です。
2はロケーション内にパートナー様の機器
を配置していただいて接続するパターン
です。
パートナー様のネットワーク機器を得て
オンプレミスに接続します。これは
パートナー様のサービスを利用する
パターンになるかと思います。
3はパートナー様のネットワーク機器が
ロケーションにある点は2と同じですが、
そこから特定の拠点に回線を引くのでは
なく、パートナー様が提供される平気を
経由するパターンです。例えばその兵から
複数の拠点に同時に接続するといったこと
が考えられます。
いくつかの接続パターンから選択
組み合わせるなどして効率的に選ぶ
クラウドへ平域接続を実現していただくと
いうことになります。
ここからダイレクトコネクトの仕組み等を
説明していきますが、基本的な
ネットワークの用語について補足させて
いただきます。
1つ目はVという言葉で物理ネットワーク
を複数の論理ネットワークに分割すること
ができる技術です。
ネットワークの柔軟な構築やセキュリティ
の向上が可能になります。
ダイレクトコネクトにおける物理的な接続
をこのVの技術を用いて論理分割して利用
します。
ノンリネットワークはVIDの番号によっ
て識別されます。
2つ目はBGPです。
IPネットワークで誰がどのIPアドレス
体を持っているのか経路の情報交換をする
ために使用されるルーティングプロトコル
のことです。ダイレクトコネクトを返して
オンプレミスとAラs間の経路交換をする
時に使われます。
それでは物理接続と論理接続の関係性に
ついて説明します。物理接続はAWS
ダイレクトコネクトのリソースとしては
コネクションまたは単に接続と表現され
ます。コネクションは単一のユーザー専用
となる専用、
またはパートナー様が確保した
コネクションから利用者に供給する形の
ホスト型の2種類があります。
そのコネクションの中にAWSクラウドに
接続するための仮想インターフェイスを
配置します。バーチャルインターフェイス
略してVIと表記します。
このVI単位でVIDを持っていてお客様
ルーターとの間でBGPPを確立すること
になります。
こちらの例だと1つの接続の中にVIが3
つあり、それぞれVIDが100300
と配置されています。
VIのタイプとして画面下に3つの記載を
していますが、プライベート、
トランジット、パブリックとそれぞれ目的
と接続パターンに合わせて使い分けて
いただく必要があります。
接続パターンの詳細は次のスライドからご
説明します。
 接続パターンについて
それではAWSダイレクトコネクトを用い
たオンプレミストAWSの接続パターンに
ついて説明していきます。
先ほどVIは3種類あると説明しましたが
、それぞれを用いた接続パターンをこちら
に上げていきます。
構成例もこの後説明をしていきますが、
目的に応じた選択をする必要がありますの
で、AWSダイレクトコネクトを利用する
にあたり、理解していただきたい内容に
なります。
オンプレミスとVPCをプライベートIP
で接続したい場合、まずダイレクト
コネクトゲートウェイの接続が選択肢と
なります。
複数のVPC、複数のリージョンのVPC
に接続が可能です。
しかし接続できるVPCの数は20個まで
なので、それより多い接続をしたい場合に
は2目にあるダイレクト
コネクトゲートウェイプ
AWSトランジットゲートウェイの接続に
する必要があります。
トランジットゲートウェイはルーティング
テーブルを複数設定できるため複雑な経路
設計が可能になります。またVPN接続
SD1との接続と様々なネットワーク拡張
も可能です。
そのような要件がある場合には
トランジットゲートウェイが選択肢となり
ます。
3行目の仮想プライベートゲートウェイの
接続は従来型の単一のVPCに対する接続
方法ですが、上の2つでこと足りるため今
は選択する必要性は少なくなってきてい
ます。
AWS上のパブリックIPに対して専用
接続を開してアクセスしたい場合には
パブリック接続が選択肢となります。それ
ではそれぞれの構成について見ていき
ましょう。
まず始めはこちらのダイレクト
コネクトゲートウェイの接続の構成です。
ダイレクトコネクトゲートウェイはAWS
ダイレクトコネクトサービスの一部で
AWSのVPCとオンレミスの
ネットワークを直接接続する役割を持つ
コンポーネントです。
頭中にある仮想プライベートゲートウェイ
とはVPCに関連付けて利用する
コンポーネントでVPCとオンプレミスを
接続するためのゲートウェイとお理解
ください。
プライベートVIF
をレクトコネクトゲートウェイ
に接続。ダイレクトコネクトゲートウェイ
からは複数のVPCの仮想プライベート
ゲートウェイに関連付けすることで1つの
プライベートVIを使い複数のVPCへ
同時に接続ができます。
ダイレクトコネクトゲートウェイは特定の
リージョンに紐づかないグローバルの
サービスで複数のリージョンのVPCを
接続することも可能です。
GPのピアは1つでデフォルトでは
ダイレクトコネクトゲートウェに関連付け
されている全てのVPCのサイダーがその
ままオンプレミスへ候補されます。
VPCは図では複数にしていますが1つで
も問題ありません。
自身でプライベートVIを作成する際に
合わせてゲートウェイタイプ、ダイレクト
コネクトゲートウェイを選択する必要が
あります。
パートナー様から払い出してもらう場合に
は希望する接続方式を伝えるようにして
ください。
こちらはプライベートVIを利用したもう
1つのタイプの仮想プライベート
ゲートウェイの接続です。
はダイレクトコネクトゲートウェイが
なくなり、プライベートVIが直接仮想
プライベートゲートウェイに関連付けされ
ています。シンプルにVIと単のVPCが
接続されるような形です。
ダイレクトコネクトゲートウェイ自体には
追加の料金がかかるものではなく、VPC
も1つから利用できるため、特別な理由が
ない限りこの従来型の方式を選択する必要
はございません。
特別な理由というのは例えばダイレクト
コネクトゲートウェイと併用ができない
AWSVPNUhubの機能が使いたいと
いったことが以前は考えられましたが放述
するトランジットゲートウェイやサイト
リンクという機能で代々ができるように
なってきたためあえて選ぶ理由がないと
いうものは現状ですのでプライベートVI
のケースではまずはダイレクトココネクト
ゲートウェイの接続から検討されるのが
推奨です。
続いてトランジットVIを利用した
ダイレクトコネクトゲートウェイとAWS
トランジットゲートウェイを利用する構成
となります。
この構成はダイレクトコネクト
ゲートウェイより多くのVPC接続を
サポートし、複数のルートテーブルを使っ
た通信制御も可能で高いスケーラビリティ
を持っています。
またトランジットゲートウェイはVPN
接続、SD1接続等の機能を持っている
ため、より複雑なネットワーク要件にも
対応できる構成です。
なお、ダイレクトコネクトゲートウェイを
単体で利用した場合と異なり、オン
プレミスに対してVPCのサイダーはその
まま候補されませんので、オンプレミスに
するプレックスリストを設定する必要が
あります。
ダイレクトコネクトゲートウェイの接続
パターンより拡張性が高く活用できる機能
も増えますが、トランジットゲートウェイ
に関わる料金が追加で発生しますので、
トランジットゲートウェイの機能が戦い
たいかどうかでダイレクトコネクト
ゲートウェイ単体の接続とどちらにするの
か判断するのがいいでしょう。
次にパブリック接続について説明します。
こちらは中国を除く全のパブリック
サービスへの接続性を提供します。
AWS上のパブリックIPの経路が
ダイレクトコネクトを貼ったBGPPに
流れてきますので専用を返してAWS上の
パブリックIPのサービスに対して
アクセスが可能になります。
AWSサービスのパブリックエンド
ポイントだったり、AWS上で展開される
サースサービスへのアクセスが例として
上げられます。
注意点としてBGP接続に利用
するパブリックIPアドレスをお客様にて
用意いただく点です。そしてお客様
ルーター側でオンレミスのプライベート
サイダーを納得する設計にもご注意
ください。
なお、2025年5月時点で約
1万2000経路を受信しますので、この
数を制限したい場合、BGPコミュニティ
で経路フィルターをすることをご検討
ください。
ホスト型接続ではPUBLVIには対応し
てない場合がございますので、事前に
パートナー様に利用化費の確認をされる
ことをお勧めいたします。
VIの種類と接続パターンは以上になり
ますが、2つ補足をさせてください。
ダイレクトコネクトは同一コネクション上
に複数種類のVIを混在させることが可能
です。
この図ではダイレクトコネクト
ゲートウェイのプライベートVIFと
パブリック接続のパブリックVIを混在に
していますが、仮想プライベート
ゲートウェイトランジットゲートウェイの
構成のVIとも混在が可能です。
コネクションを共有することで回線の効率
的な利用、環境分離、コスト最適化といっ
た論理分割するメリットを得られます。
設定できる数の上限についてはクォーター
のドキュメントをご参照ください。また、
パートナー様提供のサービスを利用する
場合はこの構成が可能かパートナー様の
技術窓口にご確認ください。
補足の2つ目はダイレクトコネクトサイト
という機能についてです。
AWSグローバルネットワークのバックを
返してオンレミISネットワーク缶を接続
するものです。
ダイレクトコネクトゲートウェイに関連
付けられたVIを利用してオンレミス環境
の通信を不可能にします。
つまり東京のお客様拠点とアメリカのお客
様拠点とをダイレクトコネクトで利用する
AWSバックボーンを経由して接続できる
というものです。
ダイレクトコネクトロケーションから
リージョンを経由せず直接AWS
バックボーンを経由して目的の
ロケーションを得最短パスの通信を可能に
します。
ダイレクトコネクトの投資を活用し、
オンレミス感の安定した通信品質を
シンプルな構成で実現できる機能です。
 冗長構成について
ここからはAWSダイレクトコネクトで
高い回復性を実現するための上調構成に
ついて説明します。
これまでお話しした通りダイレクト
コネクトは物理的な接続です。
ハードウェアの障害メンテナンス等で利用
できないことが想定されます。お客様自身
でダイレクトコネクトのダウンタイムに
備えておくことがとても重要です。
ここでは高い回復性を実現するベスト
プラクティスということでダイレクト
コネクトの上調構成のポイントを説明し
ます。
KWSでは単一障害点を排除し、あらゆる
障害に対する備えをしておくことを推奨し
ています。
ダイレクトコネクトにおいてはこちらに
上げているハードウェア、ダイレクト
コネクトでは複数の接続、オンレミス側で
は複数のルーターが該当します。
またダイレクトコネクトロケーションを
上調構成とすることが推奨されます。
さらに上ネットワーク全体で自動ロード
バシング
及び自動フェイドオーバーを行うために
BGPによる同的ルーティングされた接続
を使用することがベストプラクティスです
。
十分なネットワーク容量を確保し、1つの
ネットワーク接続に障害が起きても待機が
引迫性能低下がしないようにする必要が
あります。
システム全体としてより高い回復性を
求める場合は例えば東京、大阪の
マルチージョン構成
ダイレクトコネクト全体の障害に備えた
VPLのバックアップ経路の用意、
通信プロバイダーの上なども考慮し
ましょう。
お客様のシステムでどこまで取り入れるか
は予算ニーズに合わせて構成を検討して
ください。
では具体的なアーキテクチャ例を見ていき
ましょう。
こちらはデュアルロケーションシングル
リージョンの構成例です。
この構成は単一リージョンでのワーク
ロードとオンプレミスを接続する際に効果
性を実現する標準的な方法です。
構成のポイントとしてロケーション障害に
対応できるよう2つの異なるダイレクト
コネクトロケーションを使用しています。
ロケーション内でもハードウェア障害回線
メンテナンスに対応できるよう回線の上を
しています。
また障害があった際にはBGPにより自動
で回復できるような構成にしておきます。
優先順位付けによるアクティブ
スタンバイコール
コストマルチパスでアクティブアクティブ
などが上げられます。
ダイレクトコネクトゲートウェイVGW等
のAWSサービスはアイコンが1つで表現
していますが、内部的に上。
この構成のメリットはハードウェア障害、
回線障害、ロケーション障害に対応し自動
を実現していることです。
ダイレクトコネクトゲートウェイの接続
パターンで受視していますが、
トランジitVIを利用したトランジット
ゲートウェイの構成パターンでも利用可能
です。
こちらはデュアルロケーション
マルチリジョンの構成です。複数のAWS
リージョンを利用するワークロードと
オンレミスを接続する上構成例です。
パークロードが東京リージョン、大阪
リージョンを利用しているのに合わせ
ダイレクトコネクトロケーションも東京、
大阪と距離の離れた選択をしています。
前の例と同様にロケーション内での回線も
上長します。
複数のAWSリージョンのVPCへの接続
はグローバルサービスであるダイレクト
コネクトゲートウェイに接続しています。
トランジットゲートウェイのパターンでも
利用は可能です。
この構成のメリットはリージョン間の上性
の確保であり、災害対策としても機能し
ます。
知理的な分散によるリスク軽減を実現し
たい場合には有効な方法であり、最も高い
火用性を実現する方法の1つです。
 参考情報
本セミナーで紹介する内容は以上となり
ますが、より詳細について知りたい方向け
にもコンテンツやドキュメントがござい
ます。
こちらに他のブラックベルトオンライン
セミナー、ドキュメント、ブログ等をいく
つか記載しておりますので、知りたい内容
に合わせください。
今後ダイレクトコネクトに関する詳細編の
セミナーも計画しています。
 まとめ
最後にまとめとなります。
本日のセミナーの重要なポイントを
振り返ります。AWSダイレクトコネクト
を検討する際に抑えていただきたい接続
パターンと上構成についてお話ししました
。
サービスの概要3種類のVIプライベート
トランジットパブリックがあることまた
接続パターンについてもご紹介しました。
火用性を実現するために考慮すべき
ポイントを上構成のデータを合わせてご
紹介しました。
ここでは紹介できなかったより詳細な情報
へのリンクを本資料に記載していますので
ご活用ください。
本セミナーは以上となります。ご成聴
ありがとうございました。ご質問がござい
ましたらAラブです。またはAWS
パートナー様までお気軽にお問い合わせ
ください。
本日のセミナーが皆様のAラブデス活用の
一序となれば幸いです。引き続き
Aラブデスサービスをご活用ください。
これでAWSダイレクトコネクトの概要
セミナーを終了させていただきます。
 


