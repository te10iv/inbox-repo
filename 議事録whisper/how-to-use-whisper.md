# Whisper 音声文字起こし完全ガイド（Mac版）

## 検討：外部に情報もらさずローカルでできるもの

会社の議事録音声を**絶対に情報漏洩させずに**テキスト化するには、以下の条件を満たす必要があります：

### ✅ 安全な方法
- **ローカル完結処理**：自分のPC内で完全に処理される
- **インターネット不要**：音声データが外部に送信されない
- **オープンソース**：処理内容が透明で信頼できる

### ❌ 避けるべき方法
- **Google Docs 音声入力**：Googleサーバーに音声が送信される
- **Otter.ai / Notta などクラウド型サービス**：外部サーバーに音声がアップロードされる
- **ChatGPT API 利用**：OpenAIのクラウド環境に音声データが送られる

---

## なぜWhisperが良いか

### Whisperとは
OpenAI が無償公開している**オープンソースの音声認識モデル**で、自分のPC上で完全にローカル実行できます。

### Whisperの優位性

| 項目 | 評価 | 詳細 |
|------|------|------|
| **セキュリティ** | ⭐⭐⭐⭐⭐ | 音声データが外部に送信されない |
| **精度** | ⭐⭐⭐⭐⭐ | GoogleDocs/AmiVoiceと同等以上 |
| **コスト** | ⭐⭐⭐⭐⭐ | 完全無料（オープンソース） |
| **対応形式** | ⭐⭐⭐⭐⭐ | mp3, wav, m4a, mp4など多数対応 |
| **多言語対応** | ⭐⭐⭐⭐⭐ | 日本語含む多言語に対応 |

### 精度比較（2分30秒の音声テスト結果）

| モデル | 処理時間 | 精度 | 実務推奨 |
|--------|----------|------|----------|
| tiny | 11秒 | 80.3% | ❌ |
| base | 15秒 | 90.6% | △ |
| **medium** | 32秒 | **95.7%** | **✅ 推奨** |
| large | 6分53秒 | 99.6% | △（長時間のみ） |

> **推奨モデル**: mediumモデルが精度と速度のバランスが最良

---

## Whisper使うにしても、注意点あり

### ⚠️ 最重要セキュリティ原則（必読）

```
【絶対厳守】以下の行為は情報漏洩リスクがあります

❌ 文字起こし結果をChatGPTに貼り付けない
❌ GitHubなど外部リポジトリにpushしない
❌ iCloud / Google Drive 自動同期フォルダに置かない
❌ Zoom/Teamsのクラウド録画機能を使わない
❌ Google Docs音声入力を併用しない
```

### セキュリティ運用ルール

| 項目 | ルール |
|------|--------|
| **保存先** | ローカルディスク or 社内限定NAS |
| **暗号化** | **必須**（FileVault有効化） |
| **保存期間** | 明確に定義（不要になったら即削除） |
| **アクセス権限** | 最小限の担当者のみ |

### ✅ OK な使い方
- ローカルWhisperでの処理
- オフライン環境での実行
- USB/社内NASへの保存

### ❌ NG な使い方（即アウト）
- Web文字起こしサービス
- ChatGPTへの貼り付け
- Google Docs音声入力
- 個人クラウドストレージへの保存

---

## 導入手順（Mac）

### **【重要】環境依存の注意**

```
⚠️ バージョン依存関係がシビアです
⚠️ 必ず新規の仮想環境（venv）で構築してください
⚠️ 他のPythonプログラムに影響を与える可能性があります
```

---

### ステップ1: 事前準備（初回のみ）

#### 1-1. Homebrewのインストール
ターミナルを開いて以下を実行：

```bash
/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
```

#### 1-2. 必須ツールのインストール

```bash
brew install python ffmpeg
```

**確認コマンド：**
```bash
python3 --version
ffmpeg -version
```

---

### ステップ2: Whisperのインストール

#### **【注意】この時点でインターネット接続が必要です**
- ただし、**音声データは一切送信されません**
- インストール後はオフラインで使用可能

```bash
pip3 install openai-whisper
```

#### インストール確認
```bash
pip3 list | grep whisper
```

以下のように表示されればOK：
```
openai-whisper    x.x.x
```

---

### ステップ3: 音声ファイルの文字起こし

#### 3-1. 基本的な使い方

**コマンド例：**
```bash
whisper meeting_2025-01-10.mp3 \
  --language Japanese \
  --model medium \
  --output_format txt
```

#### 3-2. 出力形式の選択

```bash
# テキスト形式（推奨）
--output_format txt

# 字幕形式（タイムスタンプ付き）
--output_format srt

# JSON形式（詳細情報含む）
--output_format json
```

#### 3-3. モデルの選択

```bash
# 高精度・実務推奨（推奨）
--model medium

# 最高精度・長時間会議向け
--model large

# 低精度・テスト用
--model small
```

---

### ステップ4: Android録音mp3の文字起こし

#### 4-1. ファイル配置
1. AndroidスマホからMacに音声ファイルを転送
2. 専用フォルダに配置（例：`~/transcription/audio/`）

**例：**
```bash
mkdir -p ~/transcription/audio
# ファイルをこのフォルダに配置
```

#### 4-2. 実行

```bash
cd ~/transcription/audio
whisper meeting_2025-01-10.mp3 \
  --language Japanese \
  --model medium \
  --output_format txt
```

#### 4-3. 結果確認
以下のファイルが生成されます：
```
meeting_2025-01-10.txt
```

**すべてローカルで生成され、外部送信はありません**

---

### ステップ5: Mac上で流れる音声の文字起こし（リアルタイム）

Zoom/Teams会議やYouTube動画の音声をリアルタイムで文字起こしする場合

#### 5-1. BlackHoleのインストール

**BlackHole**: Macの内部音声をキャプチャする仮想オーディオデバイス（無料・ローカル）

```bash
brew install blackhole-2ch
```

#### 5-2. Macサウンド設定

1. **システム設定** → **サウンド** → **出力**
   - **BlackHole 2ch** を選択

2. **入力**
   - **BlackHole 2ch** を選択

#### **【重要】このままだと音が聞こえなくなります**

#### 5-3. 音を聞きながら使う設定

1. **Audio MIDI設定**を起動（アプリケーション > ユーティリティ）
2. **「＋」** → **複数出力装置を作成**
3. 以下にチェックを入れる：
   - ✅ **BlackHole 2ch**
   - ✅ **イヤホン** または **スピーカー**

これで音を聞きながらキャプチャできます

#### 5-4. 音声を録音 → Whisper

**録音開始：**
```bash
ffmpeg -f avfoundation -i ":BlackHole 2ch" output.wav
```

**会議終了後、Ctrl+Cで録音停止してから：**
```bash
whisper output.wav \
  --language Japanese \
  --model medium
```

---

## 実践プログラム例

### 1分毎に分割して文字起こしするプログラム

以下のような機能を持つプログラムを作成できます：
- 音声ファイルを1分毎に分割
- 各セグメントを文字起こし
- Excelファイルに結果を出力
- 音声ファイルへのリンクを自動生成

**対応形式**: wav, mp3, m4a, mp4

> 詳細なプログラムコードは、Qiitaなどで公開されています
> 検索キーワード：「Whisper 音声文字起こし Python」

---

## トラブルシューティング

### GPU関連の警告が出る場合

```
⚠️ FP16がサポートされていない
```

- これは警告メッセージで、そのまま使用可能です
- CPUで処理されますが、mediumモデルまでは実用的な速度です

### 処理が遅い場合

1. **モデルを下げる**: large → medium に変更
2. **メモリを確認**: 32GB推奨（mediumの場合）
3. **仮想環境を確認**: 他のプログラムと競合していないか

### 精度が低い場合

1. **音質を確認**: ノイズが多い音声は精度が下がります
2. **モデルを上げる**: medium → large に変更
3. **言語指定**: `--language Japanese` を必ず指定

---

## よくある質問

### Q1. 初回起動時にダウンロードが発生するのは？

**A**: モデルファイル（学習済みデータ）のダウンロードです
- 初回のみインターネット接続が必要
- **音声データは送信されません**
- 以降はオフラインで使用可能

### Q2. Google Docsとの違いは？

| 項目 | Whisper（ローカル） | Google Docs |
|------|---------------------|-------------|
| 音声送信 | ❌ なし | ✅ **あり（Google）** |
| 精度 | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ |
| オフライン | ✅ 可能 | ❌ 不可 |
| 料金 | 無料 | 無料 |
| 企業利用 | ✅ 推奨 | ❌ **非推奨** |

### Q3. GUI版はないの？

**A**: CLI（コマンドライン）が推奨です
- GUI版も存在しますが、以下に注意：
  - 「ログイン」機能 → ❌ NG
  - 「クラウド保存」 → ❌ NG
  - 「AI改善のため送信」 → ❌ NG

**安全な選択肢**: Whisper.cpp、WhisperX などのオープンソースGUI

---

## 社内説明用の一文

```
本議事録は、外部送信を伴わないローカル音声認識ツール
（OpenAI Whisper オープンソース版）を用いて作成しており、
クラウドAIサービスは一切利用していません。
```

---

## まとめ

### ✅ 最も安全な方法
1. **Whisper（ローカル実行）** を使用
2. **BlackHole** でリアルタイムキャプチャ
3. **ローカル保存** のみ
4. **クラウドサービス** は一切使わない

### ✅ 推奨設定
- **モデル**: medium（精度95.7%、処理時間32秒/2分30秒音声）
- **出力形式**: txt または srt
- **保存先**: ローカルディスク or 社内NAS
- **暗号化**: FileVault有効化

### ❌ 絶対にやってはいけないこと
- ChatGPTへの貼り付け
- Google Docs音声入力
- クラウドストレージへの自動同期
- 外部Webサービスの利用

---

## 参考情報

### 公式リソース
- GitHub: OpenAI Whisper
  - https://github.com/openai/whisper
- Whisper ドキュメント
  - コマンドオプション一覧
  - モデル詳細
  - トラブルシューティング

### 動作環境
- **OS**: macOS（M1/M2/M3 推奨）
- **Python**: 3.8以上（3.10推奨）
- **メモリ**: 8GB以上（32GB推奨）
- **ストレージ**: モデルサイズ分の空き容量（medium: 約1.5GB）

---

**最終更新**: 2025年12月17日
